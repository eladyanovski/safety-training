<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ארגון י.א מעליות - מערכת ניהול הדרכות בטיחות</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    color: #333;
    line-height: 1.6;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }
  header {
    background-color: #1a73e8;
    color: white;
    padding: 20px;
    text-align: center;
    margin-bottom: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  h1 {
    font-size: 28px;
    margin-bottom: 10px;
  }
  .form-section {
    background-color: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
  }
  .form-group {
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #555;
  }
  input[type="text"],
  input[type="date"],
  input[type="tel"],
  input[type="password"],
  select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
  }
  input[type="checkbox"] {
    margin-left: 10px;
    transform: scale(1.2);
  }
  .checkbox-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    padding: 10px;
    background-color: #f8f9fa;
    border-radius: 5px;
  }
  .checkbox-group label {
    margin-bottom: 0;
    margin-right: 10px;
    font-weight: normal;
  }
  .signature-pad {
    border: 2px solid #ddd;
    border-radius: 5px;
    margin-top: 10px;
    background-color: white;
    touch-action: none;
    width: 100%;
    height: 200px;
    display: block;
  }
  .button-group {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }
  button {
    flex: 1;
    padding: 12px 20px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .btn-primary {
    background-color: #1a73e8;
    color: white;
  }
  .btn-primary:hover {
    background-color: #1557b0;
  }
  .btn-secondary {
    background-color: #6c757d;
    color: white;
  }
  .btn-secondary:hover {
    background-color: #545b62;
  }
  .btn-danger {
    background-color: #dc3545;
    color: white;
  }
  .btn-danger:hover {
    background-color: #c82333;
  }
  .btn-success {
    background-color: #28a745;
    color: white;
  }
  .btn-success:hover {
    background-color: #218838;
  }
  .navigation-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
  }
  .admin-section {
    background-color: #fff3cd;
    border: 1px solid #ffeaa7;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
  }
  .admin-section h3 {
    color: #856404;
    margin-bottom: 15px;
  }
  .training-summary {
    background-color: white;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
  }
  .training-summary h4 {
    color: #333;
    margin-bottom: 10px;
  }
  .training-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin-top: 10px;
  }
  .detail-item {
    background-color: #f8f9fa;
    padding: 8px;
    border-radius: 3px;
  }
  .detail-item strong {
    color: #495057;
  }
  .status-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 3px;
    font-size: 12px;
    font-weight: bold;
  }
  .status-active {
    background-color: #d4edda;
    color: #155724;
  }
  .status-expired {
    background-color: #f8d7da;
    color: #721c24;
  }
  .status-warning {
    background-color: #fff3cd;
    color: #856404;
  }
  .hidden {
    display: none;
  }
  .confirmation-text {
    background-color: #e8f4f8;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
    border-right: 4px solid #1a73e8;
  }
  .training-topics {
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 5px;
    margin-bottom: 20px;
  }
  .training-topics h3 {
    color: #1a73e8;
    margin-bottom: 15px;
  }
  .topic-list {
    list-style: none;
    padding: 0;
  }
  .topic-list li {
    padding: 8px 0;
    border-bottom: 1px solid #e9ecef;
  }
  .topic-list li:last-child {
    border-bottom: none;
  }
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.5);
  }
  .modal-content {
    background-color: #fefefe;
    margin: 5% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 90%;
    max-width: 600px;
    border-radius: 10px;
    max-height: 80vh;
    overflow-y: auto;
  }
  .close {
    color: #aaa;
    float: left;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover,
  .close:focus {
    color: black;
  }
  .safety-instructions {
    margin-top: 20px;
  }
  .safety-instructions h3 {
    color: #dc3545;
    margin: 20px 0 10px 0;
    font-size: 18px;
  }
  .safety-instructions ul {
    margin-bottom: 15px;
    padding-right: 20px;
  }
  .safety-instructions li {
    margin-bottom: 5px;
  }
  .must-read-checkbox {
    background-color: #fff3cd;
    padding: 15px;
    border-radius: 5px;
    margin: 20px 0;
    border: 1px solid #ffeaa7;
  }
  .must-read-checkbox label {
    font-weight: bold;
    color: #856404;
  }
  .language-selector {
    background-color: #e3f2fd;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
    border: 1px solid #bbdefb;
  }
  .language-selector h3 {
    color: #1565c0;
    margin-bottom: 10px;
  }
  .radio-group {
    display: flex;
    gap: 20px;
    align-items: center;
  }
  .radio-group input[type="radio"] {
    margin-left: 5px;
    transform: scale(1.2);
  }
  .radio-group label {
    font-weight: normal;
    margin-bottom: 0;
  }
  .russian-text {
    direction: ltr;
    text-align: left;
    font-family: 'Times New Roman', serif;
  }
  @media (max-width: 600px) {
    .container {
      padding: 10px;
    }
    .form-section {
      padding: 20px;
    }
    .button-group {
      flex-direction: column;
    }
    .navigation-buttons {
      flex-direction: column;
    }
    .radio-group {
      flex-direction: column;
      align-items: flex-start;
      gap: 10px;
    }
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>ארגון י.א מעליות</h1>
  </header>

  <!-- Landing Page -->
  <div id="landingPage" class="form-section">
    <h2>מערכת ניהול הדרכות בטיחות</h2>
    <p>ברוכים הבאים למערכת ניהול הדרכות הבטיחות של ארגון י.א מעליות</p>
    <div class="button-group">
      <button class="btn-primary" onclick="showPeriodicForm()">הדרכה תקופתית</button>
      <button class="btn-primary" onclick="showProjectForm()">הדרכת פרויקט</button>
    </div>
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;">
      <button class="btn-secondary" onclick="showAdminLogin()">כניסת מנהל</button>
    </div>
  </div>

  <!-- Periodic Training Form -->
  <div id="periodicForm" class="form-section hidden">
    <div class="navigation-buttons">
      <button class="btn-secondary" onclick="showLanding()">חזרה לדף הבית</button>
    </div>
    <h2>טופס הדרכה תקופתית</h2>
    
    <!-- Language Selector -->
    <div class="language-selector">
      <h3>בחר שפה / Выберите язык:</h3>
      <div class="radio-group">
        <div>
          <input type="radio" id="langHebrew" name="language" value="hebrew" checked onchange="toggleLanguage()" />
          <label for="langHebrew">עברית</label>
        </div>
        <div>
          <input type="radio" id="langRussian" name="language" value="russian" onchange="toggleLanguage()" />
          <label for="langRussian">Русский</label>
        </div>
      </div>
    </div>
    
    <div class="training-topics">
      <h3>הדרכת בטיחות תקופתית</h3>
      <ul class="topic-list">
        <li>✓ סיכוני חשמל</li>
        <li>✓ עבודה בגובה</li>
        <li>✓ הרמת משאות</li>
        <li>✓ ציוד מגן אישי</li>
        <li>✓ כיבוי אש</li>
        <li>✓ חומרים מסוכנים</li>
        <li>✓ כלי עבודה</li>
        <li>✓ נעילת מעלית</li>
        <li>✓ מצבי חירום</li>
        <li>✓ סדר וניקיון</li>
        <li>✓ Take 2 - עצור וחשוב לפני ביצוע</li>
        <li>✓ סגירת פתחים וחדרי מכונה</li>
        <li>✓ נוהל כניסה ויציאה מבור המעלית</li>
        <li>✓ נוהל גישור בטחונות מעלית</li>
        <li>✓ עבודה בפיר ובור המעלית</li>
      </ul>
    </div>
    <form id="periodicTrainingForm">
      <div class="form-group">
        <label for="periodicName">שם מלא:</label>
        <input type="text" id="periodicName" name="name" required />
      </div>
      <div class="form-group">
        <label for="periodicId">מספר ת.ז:</label>
        <input type="text" id="periodicId" name="id" required />
      </div>
      <div class="form-group">
        <label for="periodicDate">תאריך:</label>
        <input type="date" id="periodicDate" name="date" required />
      </div>
      <div class="confirmation-text">
        <p><strong>אני מאשר כי:</strong></p>
        <p>קיבלתי הדרכת בטיחות מפורטת בנושאים המפורטים לעיל, הבנתי את כל ההנחיות והוראות הבטיחות, ואני מתחייב לפעול על פיהן.</p>
      </div>
      <div class="must-read-checkbox">
        <input type="checkbox" id="readInstructions" required />
        <label for="readInstructions">קראתי והבנתי את הוראות הבטיחות המפורטות</label>
        <button type="button" class="btn-primary" onclick="showSafetyInstructions()" style="margin-right: 20px;">לחץ לקריאת ההוראות</button>
      </div>
      <div class="form-group">
        <label for="periodicSignature">חתימה:</label>
        <canvas id="periodicSignature" class="signature-pad" width="400" height="200"></canvas>
        <button type="button" class="btn-secondary" onclick="clearSignature('periodicSignature')">נקה חתימה</button>
      </div>
      <div class="button-group">
        <button type="submit" class="btn-success">שלח טופס</button>
        <button type="button" class="btn-danger" onclick="resetPeriodicForm()">נקה הכל</button>
      </div>
    </form>
  </div>

  <!-- Project Training Form -->
  <div id="projectForm" class="form-section hidden">
    <div class="navigation-buttons">
      <button class="btn-secondary" onclick="showLanding()">חזרה לדף הבית</button>
    </div>
    <h2>טופס הדרכת פרויקט</h2>
    <form id="projectTrainingForm">
      <div class="form-group">
        <label for="projectName">שם הפרויקט:</label>
        <input type="text" id="projectName" name="projectName" required />
      </div>
      <div class="form-group">
        <label for="projectLocation">מיקום:</label>
        <input type="text" id="projectLocation" name="location" required />
      </div>
      <div class="form-group">
        <label for="projectDate">תאריך:</label>
        <input type="date" id="projectDate" name="date" required />
      </div>
      <div class="form-group">
        <label for="employeeName">שם העובד:</label>
        <input type="text" id="employeeName" name="employeeName" required />
      </div>
      <div class="form-group">
        <label for="employeeId">מספר ת.ז:</label>
        <input type="text" id="employeeId" name="employeeId" required />
      </div>
      <div class="form-group">
        <label for="employeePhone">טלפון:</label>
        <input type="tel" id="employeePhone" name="phone" required />
      </div>
      <div class="form-group">
        <label>נושאי ההדרכה:</label>
        <div class="checkbox-group">
          <input type="checkbox" id="electrical" name="topics" value="סיכוני חשמל" />
          <label for="electrical">סיכוני חשמל</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="heights" name="topics" value="עבודה בגובה" />
          <label for="heights">עבודה בגובה</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="lifting" name="topics" value="הרמת משאות" />
          <label for="lifting">הרמת משאות</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="ppe" name="topics" value="ציוד מגן אישי" />
          <label for="ppe">ציוד מגן אישי</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="fire" name="topics" value="כיבוי אש" />
          <label for="fire">כיבוי אש</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="hazmat" name="topics" value="חומרים מסוכנים" />
          <label for="hazmat">חומרים מסוכנים</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="tools" name="topics" value="כלי עבודה" />
          <label for="tools">כלי עבודה</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="lockout" name="topics" value="נעילת מעלית" />
          <label for="lockout">נעילת מעלית</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="emergency" name="topics" value="מצבי חירום" />
          <label for="emergency">מצבי חירום</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="cleanliness" name="topics" value="סדר וניקיון" />
          <label for="cleanliness">סדר וניקיון</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="take2" name="topics" value="Take 2 - עצור וחשוב" />
          <label for="take2">Take 2 - עצור וחשוב</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="closing" name="topics" value="סגירת פתחים וחדרי מכונה" />
          <label for="closing">סגירת פתחים וחדרי מכונה</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="pitEntry" name="topics" value="נוהל כניסה ויציאה מבור המעלית" />
          <label for="pitEntry">נוהל כניסה ויציאה מבור המעלית</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="bridging" name="topics" value="נוהל גישור בטחונות מעלית" />
          <label for="bridging">נוהל גישור בטחונות מעלית</label>
        </div>
        <div class="checkbox-group">
          <input type="checkbox" id="shaftWork" name="topics" value="עבודה בפיר ובור המעלית" />
          <label for="shaftWork">עבודה בפיר ובור המעלית</label>
        </div>
      </div>
      <div class="form-group">
        <label for="projectSignature">חתימת העובד:</label>
        <canvas id="projectSignature" class="signature-pad" width="400" height="200"></canvas>
        <button type="button" class="btn-secondary" onclick="clearSignature('projectSignature')">נקה חתימה</button>
      </div>
      <div class="button-group">
        <button type="submit" class="btn-success">שלח טופס</button>
        <button type="button" class="btn-danger" onclick="resetProjectForm()">נקה הכל</button>
      </div>
    </form>
  </div>

  <!-- Admin Login -->
  <div id="adminLogin" class="form-section hidden">
    <div class="navigation-buttons">
      <button class="btn-secondary" onclick="showLanding()">חזרה לדף הבית</button>
    </div>
    <h2>כניסת מנהל</h2>
    <form id="adminLoginForm">
      <div class="form-group">
        <label for="adminPassword">סיסמת מנהל:</label>
        <input type="password" id="adminPassword" required />
      </div>
      <button type="submit" class="btn-primary">כניסה</button>
    </form>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="form-section hidden">
    <div class="navigation-buttons">
      <button class="btn-secondary" onclick="showLanding()">יציאה</button>
    </div>
    <h2>פאנל ניהול</h2>
    <div class="admin-section">
      <h3>סיכום הדרכות</h3>
      <div id="trainingSummary"></div>
      <button class="btn-primary" onclick="exportToExcel()">ייצוא לאקסל</button>
    </div>
    <div class="admin-section">
      <h3>עובדים שצריכים חידוש הדרכה</h3>
      <div id="renewalList"></div>
    </div>
  </div>
</div>

<!-- Safety Instructions Modal -->
<div id="safetyModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeSafetyModal()">&times;</span>
    <h2>הוראות בטיחות - ארגון י.א מעליות</h2>
    <div class="safety-instructions" id="hebrewInstructions">
      <h3>1. ⚡ סיכוני חשמל</h3>
      <ul>
        <li>לפני כל עבודה חשמלית - נתק את המתח הראשי</li>
        <li>השתמש תמיד בכלי עבודה מבודדים</li>
        <li>בדוק מתח עם רב-מודד לפני נגיעה בחוטים</li>
        <li>אסור לעבוד עם ידיים רטובות</li>
      </ul>
      <h3>2. 🏗️ עבודה בגובה</h3>
      <ul>
        <li>חובה לחבוש קסדה בכל עבודה בפיר</li>
        <li>השתמש ברתמת בטיחות תקנית מעל 2 מטר</li>
        <li>וודא שהסולם יציב ונעול לפני טיפוס</li>
        <li>אסור לעבוד לבד בגובה</li>
      </ul>
      <h3>3. 🔧 הרמת משאות</h3>
      <ul>
        <li>הרם עם הרגליים, לא עם הגב</li>
        <li>משקל מעל 25 ק"ג - השתמש בעזרה או ציוד הרמה</li>
        <li>אחוז קרוב לגוף בזמן הרמה</li>
        <li>סובב את כל הגוף, לא רק המותניים</li>
      </ul>
      <h3>4. 🚨 ציוד מגן אישי</h3>
      <ul>
        <li>נעלי בטיחות - חובה בכל אתר עבודה</li>
        <li>כפפות עבודה - בעבודה עם חלקים חדים</li>
        <li>משקפי מגן - בעבודות ריתוך או חיתוך</li>
        <li>אטמי אוזניים - ברעש מעל 85 דציבל</li>
      </ul>
      <h3>5. 🔥 כיבוי אש</h3>
      <ul>
        <li>דע היכן ממוקמים המטפים באתר</li>
        <li>אש חשמלית - השתמש במטף CO2 בלבד</li>
        <li>במקרה של שריפה - התרחק והזעק עזרה</li>
        <li>אל תנסה לכבות אש גדולה לבד</li>
      </ul>
      <h3>6. ⚠️ חומרים מסוכנים</h3>
      <ul>
        <li>קרא תמיד את תווית האזהרה</li>
        <li>אחסן שמנים ודלקים הרחק מחום</li>
        <li>השתמש בכפפות בעבודה עם חומרי ניקוי</li>
        <li>אוורר את המקום בעבודה עם ממסים</li>
      </ul>
      <h3>7. 🛠️ כלי עבודה</h3>
      <ul>
        <li>בדוק כלים לפני השימוש - אין סדקים או נזקים</li>
        <li>נתק כלי חשמל מהחשמל בזמן החלפת אביזרים</li>
        <li>אחסן כלים חדים עם כיסוי מגן</li>
        <li>אל תשתמש בכלי פגום - דווח מיד</li>
      </ul>
      <h3>8. 🚪 נעילת מעלית</h3>
      <ul>
        <li>הצב שלט "מעלית בטיפול" בכל הקומות</li>
        <li>נעל את המעלית במפתח ראשי</li>
        <li>וודא שאין אנשים בתא לפני נעילה</li>
        <li>בסיום - בדוק תקינות לפני החזרה לשירות</li>
      </ul>
      <h3>9. 📱 מצבי חירום</h3>
      <ul>
        <li>טלפון חירום: 101 (מד"א), 102 (משטרה), 100 (כיבוי)</li>
        <li>דווח מיד למנהל על כל תאונה</li>
        <li>אל תזיז נפגע אלא אם יש סכנה מיידית</li>
        <li>דע היכן ערכת העזרה הראשונה</li>
      </ul>
      <h3>10. 🧹 סדר וניקיון</h3>
      <ul>
        <li>נקה את אזור העבודה בסוף כל יום</li>
        <li>אל תשאיר כלים או חלקים בפיר</li>
        <li>סלק שמנים ונוזלים מיד</li>
        <li>וודא שדרכי מילוט פנויות תמיד</li>
      </ul>
      <h3>11. 🛑 Take 2 - עצור וחשוב</h3>
      <ul>
        <li>עצור לפני תחילת כל משימה</li>
        <li>זהה סיכונים אפשריים</li>
        <li>תכנן את העבודה בבטחה</li>
        <li>וודא שיש לך את הכלים והציוד המתאימים</li>
      </ul>
      <h3>12. 🚪 סגירת פתחים וחדרי מכונה</h3>
      <ul>
        <li>סגור תמיד דלתות פיר אחרי עבודה</li>
        <li>נעל חדרי מכונה בסיום העבודה</li>
        <li>וודא שאין פתחים חשופים בפיר</li>
        <li>סמן באופן ברור אזורים מסוכנים</li>
      </ul>
      <h3>13. 🕳️ נוהל כניסה ויציאה מבור המעלית</h3>
      <ul>
        <li>וודא שהמעלית נעולה ומנותקת</li>
        <li>השתמש בסולם תקני ויציב</li>
        <li>הודע לעובד נוסף על כניסתך לבור</li>
        <li>בדוק תאורה מספקת לפני כניסה</li>
      </ul>
      <h3>14. 🔌 נוהל גישור בטחונות מעלית</h3>
      <ul>
        <li>גשר בטחונות רק כשהכרחי</li>
        <li>תעד כל גישור ביומן העבודה</li>
        <li>הסר גישורים מיד בסיום העבודה</li>
        <li>בדוק תקינות כל הבטחונות לפני הפעלה</li>
      </ul>
      <h3>15. 🏗️ עבודה בפיר ובור המעלית</h3>
      <ul>
        <li>לבש ציוד מגן מלא - קסדה, רתמה, נעלי בטיחות</li>
        <li>וודא תאורה טובה בכל אזור העבודה</li>
        <li>אל תעבוד לבד - תמיד עם עובד נוסף</li>
        <li>שמור על קשר רציף עם העובד השני</li>
      </ul>
    </div>
    
    <!-- Russian Instructions -->
    <div class="safety-instructions russian-text" id="russianInstructions" style="display: none;">
      <h3>1. ⚡ Электрические опасности</h3>
      <ul>
        <li>Перед любыми электрическими работами - отключите основное питание</li>
        <li>Всегда используйте изолированные инструменты</li>
        <li>Проверьте напряжение мультиметром перед касанием проводов</li>
        <li>Запрещено работать мокрыми руками</li>
      </ul>
      <h3>2. 🏗️ Работа на высоте</h3>
      <ul>
        <li>Обязательно носить каску при любой работе в шахте</li>
        <li>Используйте стандартную страховочную привязь выше 2 метров</li>
        <li>Убедитесь, что лестница устойчива и заблокирована перед подъемом</li>
        <li>Запрещено работать в одиночку на высоте</li>
      </ul>
      <h3>3. 🔧 Подъем грузов</h3>
      <ul>
        <li>Поднимайте ногами, а не спиной</li>
        <li>Вес свыше 25 кг - используйте помощь или подъемное оборудование</li>
        <li>Держите груз близко к телу при подъеме</li>
        <li>Поворачивайте всем телом, а не только поясницей</li>
      </ul>
      <h3>4. 🚨 Средства индивидуальной защиты</h3>
      <ul>
        <li>Защитная обувь - обязательна на любом рабочем объекте</li>
        <li>Рабочие перчатки - при работе с острыми деталями</li>
        <li>Защитные очки - при сварочных или режущих работах</li>
        <li>Беруши - при шуме свыше 85 децибел</li>
      </ul>
      <h3>5. 🔥 Пожаротушение</h3>
      <ul>
        <li>Знайте, где расположены огнетушители на объекте</li>
        <li>Электрический пожар - используйте только огнетушитель CO2</li>
        <li>В случае пожара - отойдите и вызовите помощь</li>
        <li>Не пытайтесь тушить большой пожар в одиночку</li>
      </ul>
      <h3>6. ⚠️ Опасные материалы</h3>
      <ul>
        <li>Всегда читайте предупреждающую этикетку</li>
        <li>Храните масла и топливо вдали от тепла</li>
        <li>Используйте перчатки при работе с чистящими средствами</li>
        <li>Проветривайте помещение при работе с растворителями</li>
      </ul>
      <h3>7. 🛠️ Рабочие инструменты</h3>
      <ul>
        <li>Проверяйте инструменты перед использованием - нет трещин или повреждений</li>
        <li>Отключайте электроинструменты от питания при замене принадлежностей</li>
        <li>Храните острые инструменты с защитным чехлом</li>
        <li>Не используйте поврежденный инструмент - сообщите немедленно</li>
      </ul>
      <h3>8. 🚪 Блокировка лифта</h3>
      <ul>
        <li>Разместите табличку "Лифт в обслуживании" на всех этажах</li>
        <li>Заблокируйте лифт главным ключом</li>
        <li>Убедитесь, что в кабине нет людей перед блокировкой</li>
        <li>По окончании - проверьте исправность перед возвратом в эксплуатацию</li>
      </ul>
      <h3>9. 📱 Чрезвычайные ситуации</h3>
      <ul>
        <li>Телефон экстренных служб: 101 (скорая), 102 (полиция), 100 (пожарная)</li>
        <li>Немедленно сообщите руководителю о любом несчастном случае</li>
        <li>Не перемещайте пострадавшего, если нет непосредственной опасности</li>
        <li>Знайте, где находится аптечка первой помощи</li>
      </ul>
      <h3>10. 🧹 Порядок и чистота</h3>
      <ul>
        <li>Убирайте рабочую зону в конце каждого дня</li>
        <li>Не оставляйте инструменты или детали в шахте</li>
        <li>Немедленно убирайте масла и жидкости</li>
        <li>Убедитесь, что пути эвакуации всегда свободны</li>
      </ul>
      <h3>11. 🛑 Take 2 - остановись и подумай</h3>
      <ul>
        <li>Остановитесь перед началом любой задачи</li>
        <li>Выявите возможные риски</li>
        <li>Спланируйте работу безопасно</li>
        <li>Убедитесь, что у вас есть подходящие инструменты и оборудование</li>
      </ul>
      <h3>12. 🚪 Закрытие проемов и машинных помещений</h3>
      <ul>
        <li>Всегда закрывайте двери шахты после работы</li>
        <li>Запирайте машинные помещения по окончании работы</li>
        <li>Убедитесь, что в шахте нет открытых проемов</li>
        <li>Четко обозначайте опасные зоны</li>
      </ul>
      <h3>13. 🕳️ Процедура входа и выхода из приямка лифта</h3>
      <ul>
        <li>Убедитесь, что лифт заблокирован и отключен</li>
        <li>Используйте стандартную и устойчивую лестницу</li>
        <li>Уведомите другого работника о вашем входе в приямок</li>
        <li>Проверьте достаточное освещение перед входом</li>
      </ul>
      <h3>14. 🔌 Процедура перемычки систем безопасности лифта</h3>
      <ul>
        <li>Устанавливайте перемычки только при необходимости</li>
        <li>Документируйте каждую перемычку в рабочем журнале</li>
        <li>Немедленно снимайте перемычки по окончании работы</li>
        <li>Проверьте исправность всех систем безопасности перед запуском</li>
      </ul>
      <h3>15. 🏗️ Работа в шахте и приямке лифта</h3>
      <ul>
        <li>Носите полный комплект защитного снаряжения - каску, привязь, защитную обувь</li>
        <li>Обеспечьте хорошее освещение во всей рабочей зоне</li>
        <li>Не работайте в одиночку - всегда с другим работником</li>
        <li>Поддерживайте постоянную связь со вторым работником</li>
      </ul>
    </div>
    
    <div style="margin-top: 30px; text-align: center;">
      <div id="hebrewBottom">
        <p style="font-weight: bold; color: #dc3545;">⚠️ זכור: הבטיחות שלך ושל חבריך לעבודה היא הדבר החשוב ביותר!</p>
      </div>
      <div id="russianBottom" class="russian-text" style="display: none;">
        <p style="font-weight: bold; color: #dc3545;">⚠️ Помните: ваша безопасность и безопасность ваших коллег - самое важное!</p>
      </div>
      <button class="btn-primary" onclick="confirmReadInstructions()">קראתי והבנתי / Я прочитал и понял</button>
    </div>
  </div>
</div>

<script>
  let currentLanguage = 'hebrew';

  document.addEventListener('DOMContentLoaded', function() {
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('periodicDate').value = today;
    document.getElementById('projectDate').value = today;

    initializeSignaturePad('periodicSignature');
    initializeSignaturePad('projectSignature');
  });

  function toggleLanguage() {
    const hebrew = document.getElementById('langHebrew').checked;
    const russian = document.getElementById('langRussian').checked;
    
    if (russian) {
      currentLanguage = 'russian';
    } else {
      currentLanguage = 'hebrew';
    }
    
    // Update instructions display in modal if it's open
    const modal = document.getElementById('safetyModal');
    if (modal.style.display === 'block') {
      updateInstructionsLanguage();
    }
  }

  function updateInstructionsLanguage() {
    const hebrewInstructions = document.getElementById('hebrewInstructions');
    const russianInstructions = document.getElementById('russianInstructions');
    const hebrewBottom = document.getElementById('hebrewBottom');
    const russianBottom = document.getElementById('russianBottom');
    
    if (currentLanguage === 'russian') {
      hebrewInstructions.style.display = 'none';
      russianInstructions.style.display = 'block';
      hebrewBottom.style.display = 'none';
      russianBottom.style.display = 'block';
    } else {
      hebrewInstructions.style.display = 'block';
      russianInstructions.style.display = 'none';
      hebrewBottom.style.display = 'block';
      russianBottom.style.display = 'none';
    }
  }

  function showLanding() {
    hideAllSections();
    document.getElementById('landingPage').classList.remove('hidden');
  }

  function showPeriodicForm() {
    hideAllSections();
    document.getElementById('periodicForm').classList.remove('hidden');
  }

  function showProjectForm() {
    hideAllSections();
    document.getElementById('projectForm').classList.remove('hidden');
  }

  function showAdminLogin() {
    hideAllSections();
    document.getElementById('adminLogin').classList.remove('hidden');
  }

  function showAdminPanel() {
    hideAllSections();
    document.getElementById('adminPanel').classList.remove('hidden');
    loadAdminData();
  }

  function hideAllSections() {
    document.getElementById('landingPage').classList.add('hidden');
    document.getElementById('periodicForm').classList.add('hidden');
    document.getElementById('projectForm').classList.add('hidden');
    document.getElementById('adminLogin').classList.add('hidden');
    document.getElementById('adminPanel').classList.add('hidden');
  }

  function showSafetyInstructions() {
    document.getElementById('safetyModal').style.display = 'block';
    updateInstructionsLanguage();
  }

  function closeSafetyModal() {
    document.getElementById('safetyModal').style.display = 'none';
  }

  function confirmReadInstructions() {
    document.getElementById('readInstructions').checked = true;
    closeSafetyModal();
  }

  window.onclick = function(event) {
    const modal = document.getElementById('safetyModal');
    if (event.target == modal) {
      closeSafetyModal();
    }
  }

  function initializeSignaturePad(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;

    // Set canvas size properly
    const rect = canvas.getBoundingClientRect();
    canvas.width = Math.max(400, rect.width);
    canvas.height = 200;
    
    // Set canvas display size
    canvas.style.width = '100%';
    canvas.style.height = '200px';

    ctx.strokeStyle = '#000000';
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);

    canvas.addEventListener('touchstart', handleTouch);
    canvas.addEventListener('touchmove', handleTouch);
    canvas.addEventListener('touchend', stopDrawing);

    function startDrawing(e) {
      isDrawing = true;
      [lastX, lastY] = getCoordinates(e);
    }

    function draw(e) {
      if (!isDrawing) return;
      const [currentX, currentY] = getCoordinates(e);
      ctx.beginPath();
      ctx.moveTo(lastX, lastY);
      ctx.lineTo(currentX, currentY);
      ctx.stroke();
      [lastX, lastY] = [currentX, currentY];
    }

    function stopDrawing() {
      isDrawing = false;
    }

    function handleTouch(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' :
        e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      canvas.dispatchEvent(mouseEvent);
    }

    function getCoordinates(e) {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      
      return [
        (e.clientX - rect.left) * scaleX,
        (e.clientY - rect.top) * scaleY
      ];
    }
  }

  function clearSignature(canvasId) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  document.getElementById('periodicTrainingForm').addEventListener('submit', function(e) {
    e.preventDefault();

    if (!document.getElementById('readInstructions').checked) {
      alert('יש לקרוא את הוראות הבטיחות לפני שליחת הטופס');
      return;
    }

    const canvas = document.getElementById('periodicSignature');
    if (isCanvasBlank(canvas)) {
      alert('אנא חתום בטופס לפני השליחה');
      return;
    }

    const formData = {
      type: 'periodic',
      name: document.getElementById('periodicName').value,
      id: document.getElementById('periodicId').value,
      date: document.getElementById('periodicDate').value,
      language: currentLanguage,
      signature: canvas.toDataURL(),
      timestamp: new Date().toISOString()
    };

    saveTrainingData(formData);
    alert('ההדרכה נשמרה בהצלחה!');
    resetPeriodicForm();
    showLanding();
  });

  document.getElementById('projectTrainingForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const topics = [];
    document.querySelectorAll('#projectTrainingForm input[name="topics"]:checked').forEach(checkbox => {
      topics.push(checkbox.value);
    });

    if (topics.length === 0) {
      alert('יש לבחור לפחות נושא אחד להדרכה');
      return;
    }

    const canvas = document.getElementById('projectSignature');
    if (isCanvasBlank(canvas)) {
      alert('אנא חתום בטופס לפני השליחה');
      return;
    }

    const formData = {
      type: 'project',
      projectName: document.getElementById('projectName').value,
      location: document.getElementById('projectLocation').value,
      date: document.getElementById('projectDate').value,
      employeeName: document.getElementById('employeeName').value,
      employeeId: document.getElementById('employeeId').value,
      phone: document.getElementById('employeePhone').value,
      topics: topics,
      signature: canvas.toDataURL(),
      timestamp: new Date().toISOString()
    };

    saveTrainingData(formData);
    alert('הדרכת הפרויקט נשמרה בהצלחה!');
    resetProjectForm();
    showLanding();
  });

  document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const password = document.getElementById('adminPassword').value;
    if (password === 'admin123') {
      showAdminPanel();
    } else {
      alert('סיסמה שגויה');
    }

    document.getElementById('adminPassword').value = '';
  });

  function saveTrainingData(data) {
    const trainings = getTrainings();
    trainings.push(data);
    localStorage.setItem('safetyTrainings', JSON.stringify(trainings));
  }

  function getTrainings() {
    const data = localStorage.getItem('safetyTrainings');
    return data ? JSON.parse(data) : [];
  }

  function resetPeriodicForm() {
    document.getElementById('periodicTrainingForm').reset();
    clearSignature('periodicSignature');
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('periodicDate').value = today;
    // Reset language to Hebrew
    document.getElementById('langHebrew').checked = true;
    currentLanguage = 'hebrew';
  }

  function resetProjectForm() {
    document.getElementById('projectTrainingForm').reset();
    clearSignature('projectSignature');
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('projectDate').value = today;
  }

  function loadAdminData() {
    const trainings = getTrainings();
    displayTrainingSummary(trainings);
    displayRenewalList(trainings);
  }

  function displayTrainingSummary(trainings) {
    const summaryDiv = document.getElementById('trainingSummary');
    summaryDiv.innerHTML = '';

    if (trainings.length === 0) {
      summaryDiv.innerHTML = '<p>אין הדרכות רשומות במערכת</p>';
      return;
    }

    const employeeMap = {};
    trainings.forEach(training => {
      const key = training.type === 'periodic' ? training.id : training.employeeId;
      if (!employeeMap[key]) {
        employeeMap[key] = {
          name: training.type === 'periodic' ? training.name : training.employeeName,
          trainings: []
        };
      }
      employeeMap[key].trainings.push(training);
    });

    Object.keys(employeeMap).forEach(id => {
      const employee = employeeMap[id];
      const div = document.createElement('div');
      div.className = 'training-summary';

      const latestPeriodic = employee.trainings
        .filter(t => t.type === 'periodic')
        .sort((a, b) => new Date(b.date) - new Date(a.date))[0];

      const projectCount = employee.trainings.filter(t => t.type === 'project').length;

      let html = `<h4>${employee.name} (${id})</h4>`;
      html += '<div class="training-details">';

      if (latestPeriodic) {
        const renewalDate = new Date(latestPeriodic.date);
        renewalDate.setFullYear(renewalDate.getFullYear() + 1);
        const daysUntilRenewal = Math.floor((renewalDate - new Date()) / (1000 * 60 * 60 * 24));

        let statusClass = 'status-active';
        if (daysUntilRenewal < 0) statusClass = 'status-expired';
        else if (daysUntilRenewal < 30) statusClass = 'status-warning';

        const languageInfo = latestPeriodic.language ? ` (${latestPeriodic.language === 'russian' ? 'רוסית' : 'עברית'})` : '';

        html += `
          <div class="detail-item">
            <strong>הדרכה תקופתית אחרונה:</strong> ${formatDate(latestPeriodic.date)}${languageInfo}
          </div>
          <div class="detail-item">
            <strong>תוקף עד:</strong> ${formatDate(renewalDate)}
            <span class="status-badge ${statusClass}">
              ${daysUntilRenewal < 0 ? 'פג תוקף' : daysUntilRenewal < 30 ? 'דרוש חידוש בקרוב' : 'תקף'}
            </span>
          </div>
        `;
      }

      html += `
        <div class="detail-item">
          <strong>הדרכות פרויקט:</strong> ${projectCount}
        </div>
      `;

      html += '</div>';
      div.innerHTML = html;
      summaryDiv.appendChild(div);
    });
  }

  function displayRenewalList(trainings) {
    const renewalDiv = document.getElementById('renewalList');
    renewalDiv.innerHTML = '';

    const employeeMap = {};
    trainings.forEach(training => {
      if (training.type === 'periodic') {
        const key = training.id;
        if (!employeeMap[key] || new Date(training.date) > new Date(employeeMap[key].date)) {
          employeeMap[key] = training;
        }
      }
    });

    const needsRenewal = [];
    Object.values(employeeMap).forEach(training => {
      const renewalDate = new Date(training.date);
      renewalDate.setFullYear(renewalDate.getFullYear() + 1);
      const daysUntilRenewal = Math.floor((renewalDate - new Date()) / (1000 * 60 * 60 * 24));
      if (daysUntilRenewal < 30) {
        needsRenewal.push({
          name: training.name,
          id: training.id,
          renewalDate: renewalDate,
          daysLeft: daysUntilRenewal
        });
      }
    });

    if (needsRenewal.length === 0) {
      renewalDiv.innerHTML = '<p>אין עובדים שצריכים חידוש הדרכה כרגע</p>';
      return;
    }

    needsRenewal.forEach(emp => {
      const div = document.createElement('div');
      div.className = 'training-summary';
      div.innerHTML = `
        <h4>${emp.name} (${emp.id})</h4>
        <p>תוקף הדרכה מסתיים ב-${formatDate(emp.renewalDate)} (${emp.daysLeft} ימים)</p>
      `;
      renewalDiv.appendChild(div);
    });
  }

  function formatDate(dateStr) {
    const d = new Date(dateStr);
    return d.toLocaleDateString('he-IL');
  }

  function exportToExcel() {
    const trainings = getTrainings();
    if (trainings.length === 0) {
      alert('אין נתונים לייצוא');
      return;
    }

    let csvContent = 'data:text/csv;charset=utf-8,';
    csvContent += 'סוג,שם,מספר ת.ז,תאריך,שפה,פרויקט,מיקום,טלפון,נושאי הדרכה,תאריך שמירה\n';

    trainings.forEach(t => {
      const type = t.type === 'periodic' ? 'תקופתי' : 'פרויקט';
      const name = t.type === 'periodic' ? t.name : t.employeeName;
      const id = t.type === 'periodic' ? t.id : t.employeeId;
      const date = t.date;
      const language = t.language ? (t.language === 'russian' ? 'רוסית' : 'עברית') : '';
      const projectName = t.projectName ? t.projectName : '';
      const location = t.location ? t.location : '';
      const phone = t.phone ? t.phone : '';
      const topics = t.topics ? t.topics.join('; ') : '';
      const timestamp = t.timestamp;

      const row = [type, name, id, date, language, projectName, location, phone, topics, timestamp]
        .map(field => `"${field}"`).join(',');

      csvContent += row + '\n';
    });

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement('a');
    link.setAttribute('href', encodedUri);
    link.setAttribute('download', 'safety_training_data.csv');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  function isCanvasBlank(canvas) {
    const blank = document.createElement('canvas');
    blank.width = canvas.width;
    blank.height = canvas.height;
    return canvas.toDataURL() === blank.toDataURL();
  }
</script>
</body>
</html>
